<?
class gridProcessosTramite extends MObjectGrid
{

    function __construct($objProcesso)
    {
//      construct
        global $MIOLO, $module, $self, $page;
		$processo = $objProcesso;
		$action = $MIOLO->GetActionURL($module,$self,$processo->numProcesso,array('form'=>'tramite','subform'=>'despacho','numAndamento'=>'#0#'));
        $href_grid = $MIOLO->GetActionURL($module,$self);
//      format data
        $processo->formataGridProcessosTramite();      
//      grid
       $columns = array(
            new MObjectGridColumn('numAndamento','Trâmite','center', false,'8%',true),
            new MObjectGridColumn('status','Situação','center',false,'12%',true,array('N'=>'NORMAL','J'=>'ANEXADO','A'=>'ARQUIVADO')),
            new MObjectGridColumn('setorData','Setor - Entrada','center', false,'29%',true),
            new MObjectGridColumn('setorDestinoData','Setor - Saída','center', false,'29%',true),            
			new MObjectGridColumn('decisaoData','Despacho','center', false,'22%',true),
           );         
             
            
           foreach ($processo->andamento as $proc)
            {
            	if ( !(trim($proc->decisao) == NULL ) &&  !(trim($proc->autor) == NULL) ) 
            	{   
            		$action = $MIOLO->GetActionURL($module,$self,$processo->numProcesso,array('form'=>'tramite','subform'=>'despacho','numAndamento'=>$proc->numAndamento));
            		$proc->decisaoData = "<a href='$action'>$proc->decisaoData</a>";         			
            	} 
            }
              
            
        $this->SetTitle(NULL);
        $this->SetFilter(false);
        $this->SetIndex(1);
        parent::__construct($processo->andamento,$columns, $href_grid,25);
        $controls = array(
            new MButton('btnReport','Imprimir','pdf'),
        );
        $this->setControls($controls);
        $this->SetWidth('100%');
        $this->SetLinkType('hyperlink');
        
    }
    function GenerateHeader()
    {
        return NULL;
    }
    function GenerateFooter()
    {
//      footer
        if (!$this->data) $footer[] = $this->GenerateEmptyMsg();
        $footer[] = new Separator();
        $footer[] = $this->GenerateControls();
        return $footer;
    }
}
?>
