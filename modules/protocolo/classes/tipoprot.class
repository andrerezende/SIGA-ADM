<?php
class BusinessProtocoloTipoprot extends MBusiness
{
    var $idtipoprot;
    var $tipo;
    var $diretor;
    var $gerente;
    var $coord;

    function __construct($data=NULL)
    {
        parent::__construct('sigaept',$data);
    }



    function OnCreate($idtipoprot)
    {
        if ($idtipoprot) $this->GetById($idtipoprot);
    }



    function GetById($id)
    {
       $this->idtipoprot = $id;
       $this->retrieve();
       return $this;
    }



    function getByTipo($tipo)
    {
        $criteria =  $this->getCriteria();
        $criteria->addColumnAttribute('idtipoprot');
        $criteria->addCriteria('tipo','=',"'$tipo'");
        $this->getById($criteria->retrieveAsQuery()->result[0][0]);
    }


    function listAll()
    {
        $criteria =  $this->getCriteria();
        $criteria->addOrderAttribute('tipo');
        return $criteria->retrieveAsQuery();
    }


    function selAll()
    {
        $setores = $this->listAll()->chunkResult();
        return array_combine($setores,$setores);
    }


    function ListByTipo($tipo)
    {
        $tipo = strtoupper($tipo);
    	global $MIOLO,$module;
		$sql = new MSql($columns="t.idtipoprot,t.tipo",$tables='ad_tipoprot t',$where="tipo like '%$tipo%'",$orderBy='t.tipo',$groupBy='',$having='');
		$query = $this->Query($sql);
		return $query;	
	}

}
?>
