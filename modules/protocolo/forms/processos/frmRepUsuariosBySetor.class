<?php
// 22/09/2011 Daniel Bonfim
class frmRepUsuariosBySetor extends MForm {
	public function __construct() {
		parent::__construct('Relatório de Usuários por Setor');
		$this->EventHandler();
		$this->defaultButton = false;
	}

	public function CreateFields() {
		global $MIOLO, $module, $action, $item, $theme;

        $fields = array(
			new MLookupTextField('setor','','Setor',20),
			new MHiddenField('idSetor'),
		);
        $this->SetFields($fields);

        $this->SetFieldAttr('setor','module','common');
        $this->SetFieldAttr('setor','item','setor');
        $this->SetFieldAttr('setor','related','idSetor,setor');

        $buttons = array(
			new MButton('btnPost', 'Gerar Relatório'),
		);
		$this->SetButtons($buttons);
	}

	public function btnPost_click() {

            $setor = $this->GetFormValue('setor');
            $idSetor = $this->GetFormValue('idSetor');

            if (empty($setor)) {
                    $this->addError("Selecione o Setor.");
                    return false;
            } else {
                header("Location: http://".$_SERVER['HTTP_HOST']."/relatorios2/repUsersBySetor.php?setor=$setor");
            }
                
  	}
}