<?
class frmProcessoCapa extends MForm
{
	protected $processo;
    function __construct($objProcesso)
    {
//      construct
        global $MIOLO;
		$this->processo = $objProcesso;
        parent::__construct('Imprimir capa de processo');
        $this->SetClose($MIOLO->GetActionURL('protocolo','main'));
        $this->eventHandler();
    }
   function CreateFields()
	{
//      buttons
		$buttons = Array
		(
			new MButton('btnGerarCapa', 'Imprimir Capa','pdf'),
			new MButton('btnGerarFolha', 'Imprimir Folha de Rosto','pdf')
		);
		$this->SetButtons($buttons);
	}
	function btnGerarCapa_click()
	{
		global $MIOLO;
		$data = $this->getData();		
		$report = new MJasperReport('sigaept');
		$parameters['pNumProcesso'] = $this->processo->numprocesso();
		$report->Execute('protocolo', 'ProcessoCapaSimples', $parameters);
	}	
	function btnGerarFolha_click()
	{
		global $MIOLO;
		$data = $this->getData();		
		$parameters['pNumProcesso'] = $this->processo->numprocesso();
		$parameters['pURL']           = $MIOLO->GetConf('home.url');
		$report = new MJasperReport('sigaept');
		$report->Execute('protocolo','ProcessoCapa',$parameters);
	}	
/*
Chamada do relatório em EzPDF 
	function btnGerarCapa_click()
	{
//      report
        $report = new MEzPDFReport('2','portrait');
        $report->pdf->ezSetCmMargins(8.5,2.5,3.5,2.5);
//      text report
        $tipo = array('P'=>'PROCESSO','A'=>'PROTOCOLADO');
        $report->pdf->ezText($tipo[$this->processo->tipo],12);
        $report->pdf->ezText($this->processo->instituicao.'.'.$this->processo->numProcessoFormatado(),24);
//      table report
        $options['textCol'] = array(0,0,0);
        $options['shaded'] = 0;
        $options['showLines'] = 0;
        $options['fontSize'] = 12;
        $options['maxWidth'] = 480;
        $options['xPos'] = 'left';
        $options['xOrientation'] = 'right';
        $cols = array('','');
        $dataRel[] = array('INTERESSADO:',$this->processo->solicitante);
        $dataRel[] = array('','');
        $dataRel[] = array('ENTRADA SISTEMA:',$this->processo->dataFormatada($this->processo->dataAbertura));
        $dataRel[] = array('','');
        $dataRel[] = array('SETOR ORIGEM:',$this->processo->setorOrigem);
        $dataRel[] = array('','');
        $dataRel[] = array('TÍTULO:',$this->processo->titulo);
        $dataRel[] = array('','');
        $dataRel[] = array('','');
        $dataRel[] = array('ASSUNTO:',$this->processo->assunto);
        $report->pdf->ezTable($dataRel,$cols,'',$options);
//      report
        $report->Execute();	
    }	
*/
}
?>
