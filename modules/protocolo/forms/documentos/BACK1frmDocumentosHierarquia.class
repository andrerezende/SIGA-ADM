<?
class frmDocumentosHierarquia extends MForm
{
	protected $setor;
	
    function __construct()
    {
//      construct
        global $MIOLO;
        $this->setor = $MIOLO->getBusiness('protocolo','setor');
        parent::__construct('Imprimir hierarquia');
        $this->SetClose($MIOLO->GetActionURL('protocolo','main'));
        $this->eventHandler();
    }
	
    function CreateFields()
	{
//      buttons
		$buttons = Array
		(
			new FormButton('btnGerarHierarquia', 'Imprimir hierarquia','pdf') ,
		/*	new FormButton('btnLicitacao', '## Licitacao Aquisicao ##','pdf'),
			new FormButton('btnLicitacao2', '## Licitacao Item Licita ##','pdf'),
			new FormButton('btnLicitacao3', '## Licitacao Solicitantes ##','pdf'),
			new FormButton('btnJustificativa', '## Licitacao -Justificativa ##','pdf')
	*/	);
		$this->SetButtons($buttons);
		//$fields = new MTextField('licita','','id da licitação',8);
		$this->SetFields($fields);
	}


/*	function btnGerarHierarquia_click()
	{
		global $MIOLO;
	        $report = new MJasperReport('sigaept');
		$parameters['SUBREPORT_DIR'] = $MIOLO->GetConf('home.modules').'/protocolo/reports/';
		$parameters['pURL']          = $MIOLO->GetConf('home.url');
		$parameters['pIdUsuario']    = $MIOLO->login->idkey;
		$parameters['pTitulo']       = "HIERARQUIA DE SETORES";
	        $report->Execute('protocolo', 'Hierarquia', $parameters);
	}*/


	function btnGerarHierarquia_click()
	{
		global $MIOLO;
	        $report = new MJasperReport('sigaept');
		$parameters['SUBREPORT_DIR'] = $MIOLO->GetConf('home.modules');
		$parameters['pURL']          = $MIOLO->GetConf('home.url');
		$parameters['pIdUsuario']    = $MIOLO->login->idkey;
		$parameters['pTitulo']       = "HIERARQUIA DE SETORES";
	        $report->Execute('protocolo', 'Hierarquia', $parameters);
	}


	function btnLicitacao_click()
	{
		//$i = 92; // fazer até 91
		//para gerar os relatorios de licitacao
		global $MIOLO;
		$i = $this->GetFieldValue('licita');
		$report = new MJasperReport('sigaept'); // cria o relatório
		$parameters['SUBREPORT_DIR'] 	 = $MIOLO->GetConf('home.modules').'/protocolo/reports/';//diretorio do subrelatorio
		$parameters['pURL']       	 = $MIOLO->GetConf('home.url'); // endereço da imagem
		$parameters['pConsulta']	 = $i; // id da licitacao
	        $report->Execute('protocolo', 'AquisicaoDeMateriais', $parameters); //comando para executar o relatorio
						/* ItensLicitacao , AquisicaoDeMateriais , Solicitantes */	
}
function btnLicitacao2_click()
	{
	$i = $this->GetFieldValue('licita');
		//$i = 76; // fazer até 91
		//para gerar os relatorios de licitacao
		global $MIOLO;
		$report = new MJasperReport('sigaept'); // cria o relatório
		$parameters['SUBREPORT_DIR'] 	 = $MIOLO->GetConf('home.modules').'/protocolo/reports/';//diretorio do subrelatorio
		$parameters['pURL']       	 = $MIOLO->GetConf('home.url'); // endereço da imagem
		$parameters['pConsulta']	 = $i; // id da licitacao
	        $report->Execute('protocolo', 'ItensLicitacao', $parameters); //comando para executar o relatorio
}
function btnLicitacao3_click()
	{
		$i = $this->GetFieldValue('licita');
		//$i = 76; // fazer até 91
		//para gerar os relatorios de licitacao
		global $MIOLO;
		$report = new MJasperReport('sigaept'); // cria o relatório
		$parameters['SUBREPORT_DIR'] 	 = $MIOLO->GetConf('home.modules').'/protocolo/reports/';//diretorio do subrelatorio
		$parameters['pURL']       	 = $MIOLO->GetConf('home.url'); // endereço da imagem
		$parameters['pConsulta']	 = $i; // id da licitacao
	        $report->Execute('protocolo', 'Solicitantes', $parameters); //comando para executar o relatorio
}

	function btnJustificativa_click()
	{
		
		$i = $this->GetFieldValue('licita');
		//$i = 76; // fazer até 91
		//para gerar os relatorios de licitacao
		global $MIOLO;
		$report = new MJasperReport('sigaept'); // cria o relatório
		$parameters['SUBREPORT_DIR'] 	 = $MIOLO->GetConf('home.modules').'/protocolo/reports/';//diretorio do subrelatorio
		$parameters['pURL']       	 = $MIOLO->GetConf('home.url'); // endereço da imagem
		$parameters['pConsulta']	 = $i; // id da licitacao
	        $report->Execute('protocolo', 'Justificativa', $parameters); //comando para executar o relatorio
	}	
}
?>
