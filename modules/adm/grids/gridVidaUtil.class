<?php
global $MIOLO;
$MIOLO->Uses('controls/linkvidautil.class', 'adm');

class gridVidaUtil extends MDataGrid2 {

	/**
	 * Business utilizado
	 * @var BusinessAdmVidaUtil
	 */
	public $vidautil;
	public $perms;

	public function __construct() {
		global $MIOLO, $module, $page, $context, $self, $action, $perms, $state;

		$this->vidautil = $MIOLO->GetBusiness($module, 'vidautil');

		// pega os campos do form para fazer a query
		$query = $this->vidautil->listBy(
			MForm::GetFormValue('idvidautil'),
			MForm::GetFormValue('descricao'),
			MForm::GetFormValue('anosvidautil'),
			MForm::GetFormValue('valorresidual')
		);

		$this->SetIndex(1);

		//$linkVidaUtil = new LinkVidaUtil('linkvidautil','%0%');
		$hrefVidaUtil = $MIOLO->getActionURL('adm', 'main:vidautil:edit', '#0#'); // #0# é a coluna que sera enviada, ou seja, o id

		$columns = array(
			new MDataGridColumn('idvidautil', 'Conta Contábil', 'left', true, '13%', true, null, true),
			// new DataGridControl($linkVidaUtil, 'descricao','Descrição','left',false,'60%'),
			new MDataGridHyperlink('descricao', 'Descricao', $hrefVidaUtil, '67%', true, null, true),
			// new MDataGridColumn('descricao','Descrição','left',false,'70%'),
			new MDataGridColumn('anosvidautil', 'Vida Útil (Anos)', 'right', false, '10%'),
			new MDataGridColumn('valorresidual', 'Valor residual (%)', 'right', false, '10%')
		);

		// seta > do grid
		$href_grid = $MIOLO->GetActionURL($module, $self, '', array('event' => 'btnFind'));

		parent::__construct($query, $columns, $href_grid, 25);

		$this->SetWidth('90%');
		$this->SetClose(null);
		$this->SetLinkType('hyperlink');
	}
}