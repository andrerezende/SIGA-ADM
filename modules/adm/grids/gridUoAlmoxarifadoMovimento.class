<?php
class gridUoAlmoxarifadoMovimento extends MDataGrid2 {

	/**
	 * Objeto UoAlmoxarifado
	 *
	 * @var BusinessAdmUo
	 */
	protected $objUoAlmoxarifado;

	/**
	 * Constructor
	 */
	public function __construct($objUoAlmoxarifado) {
		global $MIOLO, $page;
		$this->objUoAlmoxarifado = $objUoAlmoxarifado;

		$columns = array(
			new MDataGridColumn('idMovimento', 'IdMovimento', 'right', false, '10%', false),
			new MDataGridColumn('idMaterial', 'Id Material', 'right', false, '5%', false),
			new MDataGridColumn('descricao', 'Descrição', 'left', false, '55%', true),
			new MDataGridColumn('valorunitario', 'Valor Unitário (R$)', 'right', false, '10%', true),
			new MDataGridColumn('valorTotal', 'Valor Total (R$)', 'right', false, '10%', true),
			new MDataGridColumn('datahora', 'Data / Hora', 'center', false, '30%', true),
		);
		$this->SetFilter(false);

		$this->SetIndex(1);

		$movimento = $MIOLO->getBusiness('adm', 'movimento');

		$query = $movimento->ListMovimentosByMaterialUo($this->objUoAlmoxarifado->idMaterial, $this->objUoAlmoxarifado->idUo);
		

		$href_grid = $MIOLO->GetActionURL('adm', 'main:uoalmoxarifado', $this->objUoAlmoxarifado->idUo, array('form' => 'estorno2006', 'id' => $this->objUoAlmoxarifado->idMaterial));

		parent::__construct($query, $columns, $href_grid, 15);
		$this->SetTitle(NULL);
		$this->SetWidth('100%');
		$this->SetLinkType('hyperlink');
		$estorno = Form::GetFormValue('estorno');
		$action = $this->manager->GetActionURL('adm', 'main:uoalmoxarifado', $this->objUoAlmoxarifado->idUo, array('form' => 'estorno2006', 'id' => '#0#', 'estorno' => '1'));
		
		$this->AddActionIcon('ID', 'select.gif', $action);
	}

	public function GenerateFooter() {
		if (!$this->data) {
			$footer[] = $this->GenerateEmptyMsg();
		}
		$footer[] = new Separator();
		$footer[] = $this->GenerateControls();
		return $footer;
	}

}