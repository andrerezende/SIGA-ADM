<?php
/**
 * gridFornecedor
 *
 * @access public
 */
class gridFornecedor extends MDataGrid {

/**
 * objFornecedor
 *
 * @var BusinessAdmFornecedor
 * @access public
 */
	public $objFornecedor;

/**
 * __construct
 *
 * @global MIOLO $MIOLO
 * @global MPage $page
 * @global string $module
 * @global string $self
 * @param mixed $search
 * @return void
 */
	public function __construct($search) {
		global $MIOLO, $self, $module;

		$this->objFornecedor = $MIOLO->GetBusiness($module, 'fornecedor');

		$href = $MIOLO->getActionURL($module, 'main:fornecedor:edit', '#0#');
		$href_grid = $MIOLO->GetActionURL($module, $self, $search);

		$action = $MIOLO->GetActionURL($module, $self, '%0%', array('event' => 'btnDel:click'));
		$this->AddActionDelete($action);

		$columns = array(
			new MDataGridColumn('cnpj', 'CNPJ', 'center', '20%'),
			new MDataGridHyperlink('nome', 'Instituição', $href, '70%'),
			new MDataGridColumn('contato', 'Contato', 'center', '10%'),
		);

		$this->SetLinkType('hyperlink');
		$this->setFilter(false);

		if (isset($search) && !empty($search)) {
			$query = $this->objFornecedor->ListByNomeOuCNPJ($search);
		} else {
			$query = $this->objFornecedor->ListAll();
		}

		parent::__construct($query, $columns, $href_grid, 25);
	}

}