<?
global $MIOLO;
class gridEmpenhoMateriais extends MGrid
{
    function __construct($objEmpenho)
    {
        global $MIOLO, $page, $action;
        $this->setTitle('Situação da entrega');
        $this->width = '100%';
        $objEmpenho->retrieveAssociation('empenhado');
        foreach ($objEmpenho->empenhado as $empenhado)
        {
            foreach ($empenhado->itemLicitacao->itemreq as $material)
            {
                $codMaterial = $material->material->codmaterial;
                $dados[$codMaterial][0] = $codMaterial;
                $dados[$codMaterial][1] = $material->material->descricao;
                $dados[$codMaterial][2] += $material->quantPedida;
                $dados[$codMaterial][3] = $empenhado->quantidadeEmp;
                $dados[$codMaterial][4] += $material->quantAutorizada;
            }
        }
        $columns = array(
            new MGridColumn('Código',true,'8%'),
            new MGridColumn('Descrição','left',false,'56%'),
            new MGridColumn('Quantidade Pedida','center',true,'12%'),
            new MGridColumn('Quantidade Empenhada','center',true,'12%'),
            new MGridColumn('Quantidade Entregue','center',true,'12%'),
        );
        $this->SetFilter(false);
        parent::__construct($dados,$columns,$action,25);
        $this->SetLinkType('hyperlink');
    }
}

