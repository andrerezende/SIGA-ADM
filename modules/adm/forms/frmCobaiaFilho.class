<?php
MIOLO::Import('modules::adm::forms::frmCobaia');

class frmCobaiaFilho extends frmCobaia
{
	function __construct()
    {
		$this->Form('Cobaia Filho');
        $this->EventHandler();
    }

    function CreateFields()
    {
  	   $this->AddField(new TextField('codigo','','Código',10));
	  // $this->codigo->AddAttribute('onMouseOver',"cdgTeste(codigo.value)");
 
	   $this->CommonFields();
	   	
       $this->cpf->AddAttribute('onChange',"testaCPF(cpf.value)");

	   $this->AddField(new TextField('cargo','','Cargo',20));
       $this->AddField(new TextField('salario','','Salário',10));
	      
	   $buttons = array
			(
    	       new FormButton('btnOk', 'Ok')        	   
            );
       $this->SetButtons($buttons);

   $code = "function testaCPF(cpf){
             s = cpf;
			 if (isNaN(s)) {
			  alert ('CPF Só tem Número');
			 }
			 else
		    {
             var i;
			 var c = s.substr(0,9);
			 var dv = s.substr(9,2);
			 var d1 = 0;
			 for (i = 0; i < 9; i++) {
			  d1 += c.charAt(i)*(10-i);
			 }
			 if (d1 == 0){
			  alert ('CPF Inválido');
			 }
			 else
			{
				d1 = 11 - (d1 % 11);
				if (d1 > 9) d1 = 0;         
			 if (dv.charAt(0) != d1) {
			  alert ('CPF Inválido');         
			 }
			 else
			{
			 d1 *= 2;
			 for (i = 0; i < 9; i++) {
			  d1 += c.charAt(i)*(11-i);
			 }
			 d1 = 11 - (d1 % 11);
			 if (d1 > 9) d1 = 0;
			 if (dv.charAt(1) != d1) {
				 alert ('CPF Inválido');
             	}
             else
			 {		 
                //alert ('CPF Válido');
             }
			}
			}
		}
				
				

    	   }";
   $this->page->AddJsCode($code);
/*

  $code = "function gevan(number)		   { document.write(\"AAAAA\");			  var salario = xGetElementById(\"salario\");			  number = '' + number;			  if (number.length > 3) {			  var mod = number.length % 3;			  var output = (mod > 0 ? (number.substring(0,mod)) : '');			  for (i=0 ; i < Math.floor(number.length / 3); i++) {			  if ((mod == 0) && (i == 0))			  output += number.substring(mod+ 3 * i, mod + 3 * i + 3);			  else			  output+= ',' + number.substring(mod + 3 * i, mod + 3 * i + 3);			  }			  salario.value = output;	;		  }		   }";
  $this->page->AddJsCode($code); */

  }	

	 function btnOk_click()
	 {
        $codigo = $this->GetFieldValue('codigo');	 
		//var_dump($codigo);
	 }
}	
?>
