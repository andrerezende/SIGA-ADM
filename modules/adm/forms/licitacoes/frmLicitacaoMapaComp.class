<?
class frmLicitacaoMapaComp extends MForm
{
    protected $licitacao;
    protected $mapa;

	function __construct($licitacao)
	{
        	$this->licitacao = $licitacao;
		parent::__construct('Imprimir Mapa de Licitação');
        	$this->mapa = $this->manager->getBusiness('adm','mapalicitacao');
		$this->eventHandler();
	}
	function createFields()
	{
		$this->addButton(new MButton('btnReport','Exibir Mapa','pdf'));
//echo '<br>#####################<br>'.$this->licitacao->idTipoLicitacao.'<br>';
	}

	function btnReport_click()
	{
		global $MIOLO;
		$report = new MJasperReport('sigaept');
		$parameters['idlicitacao']    = $this->licitacao->idLicitacao;
		$parameters['SUBREPORT_DIR']  = $MIOLO->GetConf('home.modules');
		$parameters['pURL']           = $MIOLO->GetConf('home.url');
		$parameters['int_pIdUsuario'] = $MIOLO->login->idkey;
		if ($this->licitacao->idTipoLicitacao == 3){
			$report->Execute('adm', 'RelMapaCompLivros', $parameters);
		}else{
			$report->Execute('adm', 'RelMapaComparativo', $parameters);
		}
	}
}
?>
