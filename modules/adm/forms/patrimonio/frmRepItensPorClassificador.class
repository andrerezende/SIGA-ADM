<?
class frmRepItensPorClassificador extends MForm
{
    function __construct()
    {
        parent::__construct('Relatório de Itens Patrimoniais por Classificador');
        $this->EventHandler();
		$this->defaultButton = false;
    }

	function CreateFields()
    {
		global $MIOLO, $module, $action, $item, $theme;

		$fields = array(
			new MLookupTextField('classificador','','Classificador',20),
			new MHiddenField('idClassificador'),
		);
		$this->SetFields($fields);
		$this->SetFieldAttr('classificador','module',$module);
		$this->SetFieldAttr('classificador','item','classificador');
		$this->SetFieldAttr('classificador','related','idClassificador,classificador');

		$buttons = array(
			new MButton('btnPost','Gerar Relatório','PDF'),
		);
		$this->SetButtons($buttons);
	}

    function btnPost_click()
    {
	global $MIOLO, $module, $item;
	
        $report = new MJasperReport('sigaept'); 
        $parameters['SUBREPORT_DIR']	= $MIOLO->GetConf('home.modules');
        $parameters['int_pIdUsuario']	= $MIOLO->login->idkey;
     	$parameters['pClassificador']	= Form::GetFormValue('idClassificador'); 
        $parameters['pURL']		= $MIOLO->GetConf('home.url');
 
        $report->Execute('adm', 'itensPorClassificador', $parameters);



	}
}
?>
