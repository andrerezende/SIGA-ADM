<?php
class frmIrrfDel extends MForm
{
	protected $objIrrf;

    function __construct($objIrrf)
    {
		$this->objIrrf = $objIrrf;
        parent::__construct('Excluir IRRF');
        $this->eventHandler();
    }
	
    
    function CreateFields()
    {
		$action_sim = $this->manager->getActionURL('adm','main:irrf',$this->objIrrf->idIrrf,array('form'=>'excluir','conf'=>'sim'));
		$action_nao = $this->manager->getActionURL('adm','main:irrf',$this->objIrrf->idIrrf);

		$conf = $this->GetFormValue('conf');

		if ($conf == 'sim')
		{
			try
			{
				$this->objIrrf->delete();
				$this->objIrrf->log(OP_DEL,"IRRF excluído");
				$this->manager->information('IRRF excluído com sucesso',$this->manager->getActionURL('adm','main:irrf:find'));
			}
			catch (Exception $e)
			{
				$this->manager->error("Informe o seguinte erro à equipe do CGCO: ".$e->getMessage,$this->manager->getActionURL('adm','main:irrf',$this->objIrrf->idIrrf));
			}
	    }
	    else
	    {
		   $this->manager->question("Tem certeza que deseja excluir esse IRRF?",$action_sim,$action_nao);
		}
    }

 }
?>
