<?
/*
  Gevã Schaefer Pereira Martins 
*/
class frmItensOrcamento extends Form
{
   var $objFonte;
   var $ItemLicitacao;
   
   function __construct()
   {
 	  global $MIOLO, $module, $self, $item;
  	  $this->listURL = $MIOLO->GetActionURL($module,$self,'',Array('event'=>'btnList:click') );
 	 // $this->objFonte = $MIOLO->GetBusiness('adm','fonte');
 	  $this->Form('Fonte');
 	  $this->EventHandler();
      $this->ItemLicitacao = $item;
   }

   function CreateFields()
   {
      global $MIOLO,$module,$self, $action, $auth, $item;
	  $fields = array
      (
	    new LookupTextField('lkpOrcamento','','Orçamento',20)
       //	new LookupTextField('lkpOrcamento2','','Orçamento',20,'',null,'HidIdorcamento,lkpOrcamento','adm','Orcamento2','filler')
	  );

      $this->SetFields($fields);

      $this->SetFieldAttr('lkpOrcamento','module',$module);
      $this->SetFieldAttr('lkpOrcamento','item','Orcamento');
      $this->SetFieldAttr('lkpOrcamento','event', 'filler');
 	  $this->SetFieldAttr('lkpOrcamento','related', 'lkpOrcamento');

	  $buttons = array
      (
	     new FormButton('btnPost', 'Enviar'),
	  );
      $this->SetButtons($buttons);
   }

   function GetData()
	{
       $data = new FormData();
	   $data->descricao = $this->GetFieldValue('descricao');		
       return $data;
	}

   function btnPost_click()
   {
	 global $MIOLO, $module, $self, $action;
     $objFonte = $MIOLO->GetBusiness($module,'fonte');
	 $objFonte->SetData($this->GetData());
	 $ok = $objFonte->Insert();
	 if ( $ok )
	 {
	    $MIOLO->Information('Fonte adicionada com sucesso.', $action );
		return true;
	 }
	 $this->AddError($objFonte->GetErrors());
   }
}
?>