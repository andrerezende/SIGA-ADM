<?
class BusinessAdmUnidade extends Business
{
	public $sigla;
	public $descricao;
        public $id;
	

	function __construct($data = null)
    {
       parent::__construct('sigaept',$data);
    }
        
        function GetById($sigla)
	{
		$this->sigla = $sigla;
		$this->retrieve();
		return $this;
	} 
 
    function OnCreate($data)
    {
        if (empty($data))
        {

        }
        else
        {
            $this->GetById($data);
        }
    }
	
        
      function ListAll()
	{
        $criteria =  $this->getCriteria();
        $criteria->addOrderAttribute('sigla');
        return $criteria->retrieveAsQuery();
	}
        
        function ListAllNovo()
         {
             $criteria =  $this->getCriteria();
	    $criteria->AddColumnAttribute('sigla');
            $criteria->addOrderAttribute('sigla');
            $query = $criteria->retrieveAsQuery();

             return $query;
        }
        
       function ListById($sigla)
        {
            $criteria =  $this->getCriteria();
            $criteria->addCriteria('sigla','LIKE', "$sigla");
            $criteria->addOrderAttribute('sigla');
            return $criteria->retrieveAsQuery();
       }
       
       function ListByNome($sigla)
	{
		$sigla= strtoupper($sigla);
		$criteria =  $this->getCriteria();
		$criteria->addCriteria('upper(sigla)','LIKE', "'%$sigla%'");
		$criteria->addOrderAttribute('sigla');
		return $criteria->retrieveAsQuery();
	}
        function selAllById()
    {
        return $this->ListAllNovo()->chunkResult();
    }
    
    function GetSiglaDecricao()
	{
		$query ="select sigla, descricao from ad_unidade";

		$sql = new sql($query);
		$query = $this->Query($sql);
		return $query->result;
	}
        
        function getUnidade($sigla)
	{
           $sigla = strtoupper($sigla);

		$sql = new sql("sigla, descricao", "ad_unidade",""); 
           if($sigla){
				$sql->SetWhere("sigla  like  '$sigla'");
		     }
                     $sql->SetOrderBy("sigla");
		     $query = $this->Query($sql);
		     return $query;
        }
}
?>