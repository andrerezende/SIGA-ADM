<?
class BusinessAdmDependencia extends Business
{
    public $idDependencia;
	public $dependencia;
	public $idSetor;
	public $setor;

	function __construct($data = null)
    {
       parent::__construct('sigaept',$data);
    }

	function GetById($idDependencia)
	{
		$this->idDependencia = $idDependencia;
		$this->retrieve();
		return $this;
	} 
    function OnCreate($data)
    {
        if (empty($data))
        {

        }
        else
        {
            $this->GetById($data);
        }
    }
	function ListById($dependencia,$setor)
	{
		$criteria = $this->getCriteria();
		$criteria->AddColumnAttribute('idDependencia');
		$criteria->AddColumnAttribute('dependencia');
		$criteria->AddColumnAttribute('idSetor');
		$criteria->AddColumnAttribute('setor.sigla');
		$criteria->AddColumnAttribute('setor.nome', 'setor');
		$criteria->addCriteria('dependencia','LIKE', "$dependencia");
		$cc = new CriteriaCondition();
		$cc->addCriteria($criteria->getCriteria('setor.sigla','LIKE', "$setor"));
		$cc->addOrCriteria($criteria->getCriteria('setor.nome','LIKE', "$setor"));
		$criteria->addCriteria($cc);
		$criteria->addOrderAttribute('setor.nome');
		$criteria->addOrderAttribute('dependencia');
		return $criteria->retrieveAsQuery();
	}
}
?>
