<?
class BusinessAdmBolsa extends Business
{
	var $idbolsa;
	var $descricao;
    var $paga, $frequencia;

	function BusinessAdmBolsa($data = null)
	{
		$this->Business('sigaept',$data);
	}

  	function ListRange($idlogin='',$tipo='',$range=NULL)
  	{
		$tabelas = 'ad_bolsa';

		if( $idlogin!='' )
		{ //seleciona somente bolsas que usuario $idlogin tem acesso
			$tabelas .= ', ad_acessobolsa';
			$condicao = "ad_bolsa.idbolsa = ad_acessobolsa.idbolsa AND ad_acessobolsa.idusuario = $idlogin";
		}
		
		if( $tipo == 'paga' )
		{
			$condicao .= " AND ad_bolsa.paga = 'S'";
		}
	
		$sql = new sql('ad_bolsa.idbolsa,ad_bolsa.descricao',$tabelas);

		$sql->where = $condicao;
	
		$sql->SetOrderBy('descricao');
		$sql->SetRange($range);
		$query = $this->Query($sql);
		return $query;
  	}
	
	function ListAll($idlogin='',$tipo='')
  	{
		return $this->ListRange($idlogin,$tipo);
	}

	function GetById($idbolsa='')
	{
		$sql = new sql('descricao','ad_bolsa');
		$sql->where = "idbolsa = $idbolsa";
		
		$query = $this->Query($sql);

		return $query;
	}
	
	function GetNumRegs()
	{
		$sql = new sql('count(*) as numregs','ad_bolsa');
		
		$query = $this->Query($sql);
		
		return $query->result[0][0];
	}
}
?>
