<?
class BusinessAdmPrevRevisao extends Business
{
    public $idPrevRevisao;
    public $placa;
    public $dataPrevista;
    public $kmEstimada;
    public $situacao;
    public $obs;
    
    public $veiculo;
    public $balanco;
        
    function __construct($data=NULL)
    {
        $this->Business('sigaept',$data);
    }
    function GetById($id)
    {
		$this->idPrevRevisao = $id;
		$this->retrieve();
    }
    function setData($data)
    {
        $this->placa = $data->placa;
		$this->dataPrevista = $data->dataPrevista;
		$this->kmEstimada = $data->kmEstimada;
		$this->situacao = $data->situacao;
		$this->obs = $data->obs;        
    }
    function getData()
    {
		$data->placa = $this->placa;
		$data->dataPrevista = $this->dataPrevista;
		$data->kmEstimada = $this->kmEstimada;
		$data->situacao = $this->situacao;
		$data->obs = $this->obs;
		return $data;
    }
    function setVeiculo($placa)
    {
		$this->placa = $placa;
    }
    function getVeiculo()
    {
        $this->retrieveAssociation('veiculo');
    }
    function listAll()
    {
        global $MIOLO;
        
		$criteria =  $this->getCriteria();
		$criteria->addOrderAttribute('situacao');
        $criteria->addOrderAttribute('dataPrevista');
        return $criteria->retrieveAsQuery();
    }
    function getBalanco()
    {
		$sql = new MSql();	
    }	
    function listRevisoesPrevistas()
    {
    	$data = date('d/m/Y');
    	$criteria =  $this->getCriteria();
        $criteria->addCriteria("data_prevista - '$data'",'<', "20");
        $criteria->addCriteria('situacao','=',"'1'");
        return $criteria->retrieveAsQuery();
    }
}
?>
