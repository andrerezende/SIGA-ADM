<?
class BusinessAdmBolsaEstagio extends Business
{
	var $idbolsaestagio;
	var $descricao;

	function BusinessAdmBolsaEstagio($data = null)
	{
		$this->Business('sigaept',$data);
	}

  	function ListRange($idlogin='',$tipo='',$range=NULL)
  	{
		$tabelas = 'ad_bolsaestagio';

		if( $idlogin!='' )
		{ //seleciona somente bolsas que usuario $idlogin tem acesso
			$tabelas .= ', ad_acessobolsa';
			$condicao = "ad_bolsaestagio.idbolsaestagio = ad_acessobolsa.idbolsaestagio AND ad_acessobolsa.idusuario = $idlogin";
		}
		
		if( $tipo == 'paga' )
		{
			$condicao .= " AND ad_bolsaestagio.paga = 'S'";
		}
	
		$sql = new sql('ad_bolsaestagio.idbolsaestagio,ad_bolsaestagio.descricao',$tabelas);

		$sql->where = $condicao;
	
		$sql->SetOrderBy('descricao');
		$sql->SetRange($range);
		$query = $this->Query($sql);
		return $query;
  	}
	
	function ListAll($idlogin='',$tipo='')
  	{
		return $this->ListRange($idlogin,$tipo);
	}

	function GetById($idbolsaestagio='')
	{
		$sql = new sql('descricao','ad_bolsaestagio');
		$sql->where = "idbolsaestagio = '$idbolsaestagio'";
		
		$query = $this->Query($sql);

		return $query;
	}
	
	function GetNumRegs()
	{
		$sql = new sql('count(*) as numregs','ad_bolsaestagio');
		
		$query = $this->Query($sql);
		
		return $query->result[0][0];
	}
}
?>