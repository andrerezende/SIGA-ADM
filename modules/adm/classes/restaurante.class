<?
class BusinessAdmRestaurante extends Business
{
    public $idRestaurante;
    public $nome;
    public $ativo;
    public $valorRefeicao;

    function __construct($data = null)
    {
        parent::__construct('sigaept', $data);
    }

    function OnCreate($data)
    {
        if (!empty($data))
        {
            $this->GetById($data);
        }
    }

    function GetById($id)
    {
        $this->idRestaurante = $id;
        $this->retrieve();
        return $this;
    }

    function ListAll()
    {
        $criteria =  $this->getCriteria();
        return $criteria->retrieveAsQuery();
    }

    function ListByNome($nome)
    {   
        $criteria =  $this->getCriteria();
	$nome = strtoupper($nome);
        $criteria->addCriteria('nome','like', "'%$nome%'");
	$criteria->addOrderAttribute('nome');
        return $criteria->retrieveAsQuery();

    }
    
    function ListAtivos()
    {
        $criteria =  $this->getCriteria();
        $criteria->addCriteria('ativo','=', '1');
        return $criteria->retrieveAsQuery();
    }

	function countAtivos()
	{
		$sql = new sql('count(*) as numregs','ad_restaurante');
		$query = $this->Query($sql);
		return $query->result[0][0];
	}
}
?>
