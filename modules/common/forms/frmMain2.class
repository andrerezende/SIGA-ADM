<?php

// 24-10-2011 - Daniel Bonfim

/**
 * Form com o menu principal do handler: common/handlers/main2.inc
 * 
 */
class frmMain2 extends MCompoundForm {

    function __construct($user) {
        global $MIOLO, $module;

        parent::__construct(NULL);
        //$this->SetClose($MIOLO->GetActionURL($module,'main:patrimonio'));
        $this->EventHandler();
        $this->defaultButton = false;
    }

    function CreateFields() {
        global $MIOLO, $page, $module, $context, $history, $perms, $action, $ui;

        $ui = $MIOLO->GetUI();
        $this->_panel[0] = $cmPanel = new ActionPanel('pnlMain', 'SIGA - Menu Principal');


        //    $cmPanel->setControlSize('600px','15px');
        $cmPanel->AddUserAction('adm', A_ACCESS, 'Administração', $ui->GetImageTheme('', 'icons/administracao.png'), 'adm', 'main');
        //09/04/2012 - Tiago Macedo
        $cmPanel->AddUserAction('prot', A_ACCESS, 'Abertura de processo', $ui->GetImageTheme('', 'icons/protocolo.png'), 'protocolo', 'main:processos:new');
        $cmPanel->AddUserAction('prot', A_ACCESS, 'Protocolo', $ui->GetImageTheme('', 'icons/protocolo.png'), 'protocolo', 'main:processos:find');
        // aqui da erro pq ele precisa que a variavel $user seja enviada
        $cmPanel->AddUserAction('prot', A_ACCESS, 'Pendências de Protocolo', $ui->GetImageTheme('', 'icons/protocolo.png'), 'protocolo', 'main:processos:pendentes');
        $cmPanel->AddUserAction('PROT_CONF', A_EXECUTE, 'Configuração', $ui->GetImageTheme('', 'icons/configuracao.png'), 'protocolo', 'main:configuracao');
        if (!$MIOLO->getPerms()->isAdmin())
        $cmPanel->AddUserAction('rh', A_ACCESS, 'Recursos Humanos', $ui->GetImageTheme('', 'icons/pessoas2.png'), 'rh', 'main');
        if ($MIOLO->getPerms()->isAdmin()) {
            $cmPanel->AddAction('MAD', $ui->GetImageTheme('', 'icons/MAD.png'), $module, 'main:mad');
        }
        $cmPanel->AddAction('Alterar sua senha', $ui->GetImageTheme('', 'icons/alterar_sua_senha.png'), $module, 'main:password');
        $cmPanel->AddUserAction('trocasenha', A_ACCESS, 'Troca Senha de Usuário', $ui->GetImageTheme('', 'icons/alterar_senha_de_usuario.png'), 'common', 'main:trocasenha');

        if (!$MIOLO->getPerms()->isMemberOf('', 'SIGA_FUNCIONARIO')) {
            $cmPanel->AddAction('Dados Pessoais', $ui->GetImageTheme('', 'icons/dados_pessoais.png'), $module, 'dadospessoais');
        }
        if ($MIOLO->getPerms()->isAdmin()) {
            $cmPanel->AddAction('Versão do Sistema', $ui->GetImageTheme('', 'icons/MAD.png'), $module, 'main:versaosistemas');
                  
        }
        $cmPanel->AddAction('Sair', $ui->GetImageTheme('', 'icons/sair.png'), $module, 'logout');
    }

}